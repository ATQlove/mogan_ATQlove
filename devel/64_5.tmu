<TMU|<tuple|1.0.1|2.1.2>>

<style|<tuple|tmdoc|british|devel>>

<\body>
  <tmdoc-title|Error when rendering inserted SVG image>

  <section|Bug Metadata>

  <\itemize>
    <item>Reporter: Darcy on <hlink|Gitee|https://gitee.com/XmacsLabs/mogan/issues/I5VYLZ>

    <item>Owner: Darcy Shen

    <item>Tester: Darcy Shen
  </itemize>

  <section|How to reproduce it>

  Just insert a local svg image to reproduce the bug.

  Here is the inserted svg image 1:

  <image|<tuple|<#3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D226E6F223F3EE2809ACB993C737667E2809ACB99202020786D6C6E733A64633D22687474703A2F2F7075726C2E6F72672F64632F656C656D656E74732F312E312F22E2809ACB99202020786D6C6E733A63633D22687474703A2F2F6372656174697665636F6D6D6F6E732E6F72672F6E732322E2809ACB99202020786D6C6E733A7264663D22687474703A2F2F7777772E77332E6F72672F313939392F30322F32322D7264662D73796E7461782D6E732322E2809ACB99202020786D6C6E733A7376673D22687474703A2F2F7777772E77332E6F72672F323030302F73766722E2809ACB99202020786D6C6E733D22687474703A2F2F7777772E77332E6F72672F323030302F73766722E2809ACB99202020786D6C6E733A736F6469706F64693D22687474703A2F2F736F6469706F64692E736F75726365666F7267652E6E65742F4454442F736F6469706F64692D302E64746422E2809ACB99202020786D6C6E733A696E6B73636170653D22687474703A2F2F7777772E696E6B73636170652E6F72672F6E616D657370616365732F696E6B736361706522E2809ACB9920202077696474683D22323422E2809ACB992020206865696768743D22323422E2809ACB9920202069643D227376673533373522E2809ACB9920202076657273696F6E3D22312E3122E2809ACB99202020696E6B73636170653A76657273696F6E3D22312E302E31202863343937623033632C20323032302D30392D31302922E2809ACB99202020736F6469706F64693A646F636E616D653D22746D5F636C6F75642E73766722E2809ACB99202020696E6B73636170653A6578706F72742D66696C656E616D653D222F55736572732F7664686F6576656E2F6D616769782F7465786D6163732F69636F6E732F746D5F6E65772E706E6722E2809ACB99202020696E6B73636170653A6578706F72742D786470693D22393022E2809ACB99202020696E6B73636170653A6578706F72742D796470693D223930223EE2809ACB9920203C64656673E2809ACB99202020202069643D22646566733533373722202F3EE2809ACB9920203C736F6469706F64693A6E616D656476696577E2809ACB99202020202069643D226261736522E2809ACB99202020202070616765636F6C6F723D222366666666666622E2809ACB992020202020626F72646572636F6C6F723D222336363636363622E2809ACB992020202020626F726465726F7061636974793D22312E3022E2809ACB992020202020696E6B73636170653A706167656F7061636974793D22302E3022E2809ACB992020202020696E6B73636170653A70616765736861646F773D223222E2809ACB992020202020696E6B73636170653A7A6F6F6D3D2232322E33393536303422E2809ACB992020202020696E6B73636170653A63783D22312E3638313434373122E2809ACB992020202020696E6B73636170653A63793D2231342E33363938393822E2809ACB992020202020696E6B73636170653A63757272656E742D6C617965723D226C617965723122E2809ACB99202020202073686F77677269643D227472756522E2809ACB992020202020696E6B73636170653A677269642D62626F783D227472756522E2809ACB992020202020696E6B73636170653A646F63756D656E742D756E6974733D22707822E2809ACB992020202020696E6B73636170653A77696E646F772D77696474683D223136353022E2809ACB992020202020696E6B73636170653A77696E646F772D6865696768743D223132313122E2809ACB992020202020696E6B73636170653A77696E646F772D783D2232353622E2809ACB992020202020696E6B73636170653A77696E646F772D793D22323322E2809ACB992020202020696E6B73636170653A77696E646F772D6D6178696D697A65643D223022E2809ACB992020202020696E6B73636170653A646F63756D656E742D726F746174696F6E3D2230223EE2809ACB99202020203C696E6B73636170653A67726964E2809ACB9920202020202020747970653D2278796772696422E2809ACB992020202020202069643D22677269643533383322E2809ACB9920202020202020656D7073706163696E673D223822E2809ACB992020202020202076697369626C653D227472756522E2809ACB9920202020202020656E61626C65643D227472756522E2809ACB9920202020202020736E617076697369626C65677269646C696E65736F6E6C793D227472756522E2809ACB992020202020202073706163696E67783D22302E3522E2809ACB992020202020202073706163696E67793D22302E3522E2809ACB99202020202020206F726967696E783D223022E2809ACB99202020202020206F726967696E793D223022202F3EE2809ACB9920203C2F736F6469706F64693A6E616D6564766965773EE2809ACB9920203C6D65746164617461E2809ACB99202020202069643D226D6574616461746135333830223EE2809ACB99202020203C7264663A5244463EE2809ACB992020202020203C63633A576F726BE2809ACB992020202020202020207264663A61626F75743D22223EE2809ACB9920202020202020203C64633A666F726D61743E696D6167652F7376672B786D6C3C2F64633A666F726D61743EE2809ACB9920202020202020203C64633A74797065E2809ACB9920202020202020202020207264663A7265736F757263653D22687474703A2F2F7075726C2E6F72672F64632F64636D69747970652F5374696C6C496D61676522202F3EE2809ACB9920202020202020203C64633A7469746C653E3C2F64633A7469746C653EE2809ACB992020202020203C2F63633A576F726B3EE2809ACB99202020203C2F7264663A5244463EE2809ACB9920203C2F6D657461646174613EE2809ACB9920203C67E2809ACB99202020202069643D226C617965723122E2809ACB992020202020696E6B73636170653A6C6162656C3D224C61796572203122E2809ACB992020202020696E6B73636170653A67726F75706D6F64653D226C61796572223EE2809ACB99202020203C70617468E2809ACB99202020202020207374796C653D2266696C6C3A236666666666663B66696C6C2D6F7061636974793A302E3837383433313B7374726F6B653A233030303030303B7374726F6B652D77696474683A313B7374726F6B652D6C696E656361703A627574743B7374726F6B652D6C696E656A6F696E3A6D697465723B7374726F6B652D6D697465726C696D69743A343B7374726F6B652D6461736861727261793A6E6F6E653B7374726F6B652D6F7061636974793A302E35303232323222E2809ACB9920202020202020643D224D20342E303839333033322C382E37333230393033204320352E303633313537372C382E3332383730363320372C3920372C3920372C3920382E383235343731332C352E393531353231332031312E3233323538312C362E303632333136332031332E3735393037382C362E313738363036352031352C382031352C382031352C382031362E3035313537352C362E3838303838362031372E3535333937352C372E353632383037312031382E3931303639372C382E313738363036352031392C392E352031392C392E35206320302C3020312E3832383233312C2D302E3630393431333320322E3832313339332C302E35323639383720312E3335363632332C312E353532323820302E3534343635322C342E393238333631202D302E3738353537362C352E37333230393120432031392E3731323637352C31362E35353835332031382E352C31362E352031382E352C31362E35206320302C30202D322E3138373537392C302E3034363136202D332E3336363034342C302E303335383220432031332E3739303239372C31362E35323430332031322C31362E352031322C31362E352031322C31362E3520382E373637373639322C31362E3530313520372E353839333033322C31362E3439313220362E323435363435322C31362E343739333820362E352C31362E3520352C31362E3520322E352C31362E3520312E353832343634382C31332E35343631363720312E373332303930322C31312E38313235363120312E383238323239322C31302E36393836363820332E303536333734352C392E3135393934323920342E303839333033322C382E37333230393033205A22E2809ACB992020202020202069643D22706174683533383522E2809ACB9920202020202020696E6B73636170653A636F6E6E6563746F722D6375727661747572653D223022E2809ACB9920202020202020736F6469706F64693A6E6F646574797065733D2273637363736373736373637363737322202F3EE2809ACB9920203C2F673EE2809ACB993C2F7376673EE2809ACB99>|tm_cloud.svg>|18pt|18pt||>

  Here is the linked local svg image 1:

  <image|../TeXmacs/misc/pixmaps/modern/24x24/main/tm_cloud.svg||||>

  Here is the linked local svg image 2:

  <image|../TeXmacs/misc/pixmaps/modern/24x24/main/tm_find.svg||||>

  <section|Solution>

  <subsection|The root cause>

  Root cause for the inserted svg image 1 is that load_string from a ramdisc url is broken.

  Root cause for the linked local svg image 2 is that svg_image_size failed to get the size of the image.

  <subsection|How to fix it>

  Use tm_load_string and make it work for ramdisc url.

  Just fix <cpp|svg_image_size>.

  <tmdoc-copyright|2023|Who>

  <tmdoc-license|Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.1 or any later version published by the Free Software Foundation; with no Invariant Sections, with no Front-Cover Texts, and with no Back-Cover Texts. A copy of the license is included in the section entitled "GNU Free Documentation License".>
</body>

<\initial>
  <\collection>
    <associate|page-medium|papyrus>
  </collection>
</initial>